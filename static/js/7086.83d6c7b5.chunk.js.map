{"version":3,"file":"static/js/7086.83d6c7b5.chunk.js","mappings":"oSAGe,SAASA,IACtB,OAA0BC,EAAAA,EAAAA,WAAS,GAAnC,eAAOC,EAAP,KAAcC,EAAd,KACA,GAA4BF,EAAAA,EAAAA,YAA5B,eAAOG,EAAP,KAAeC,EAAf,KACIC,EAAYC,KAAKC,MAAMC,aAAaC,QAAQ,eAChDC,EAAAA,EAAAA,YAAS,iBAAC,2FACRC,EAAAA,GAAAA,UADQ,SAEWC,IAAAA,IAAU,uCAFrB,cAEFC,EAFE,OAGRC,EAAcD,EAAKE,KAAKA,MAHhB,mBA6BD,eA7BC,2CA+BP,IACH,OAAoCf,EAAAA,EAAAA,UAAS,GAA7C,eAAOgB,EAAP,KAAmBF,EAAnB,KA6BMG,EAAU,CACd,CACEC,MAAO,2BACPC,UAAW,OACXC,MAAO,OAET,CACEF,MAAO,eACPC,UAAW,QACXC,MAAO,MACPC,OAAQ,SAACC,EAAMC,GAAP,OACN,gBAAKC,MAAO,CAAEC,QAAS,OAAQC,eAAgB,gBAAiBC,WAAY,UAA5E,UACE,SAAC,IAAD,CACEP,MAAO,IACPQ,OAAQ,IACRC,IAAG,gDAA2CN,EAAOO,UAK7D,CACEZ,MAAO,eACPC,UAAW,QACXC,MAAO,MACPW,MAAO,SACPC,iBAAkB,UAClBC,OAAQ,SAACC,EAAGC,GAAJ,OAAUD,EAAEE,MAAQD,EAAEC,QAEhC,CACElB,MAAO,eACPC,UAAW,QACXC,MAAO,MACPW,MAAO,UAET,CACEb,MAAO,SACPmB,IAAK,SACLjB,MAAO,MACPC,OAAQ,SAACC,EAAMC,GAAP,OACN,SAAC,IAAD,CAAOe,KAAK,SAAZ,UACE,SAAC,IAAD,CAAQC,KAAK,UAAUC,QAAS,WApEvB,IAACV,EAAAA,EAoEsCP,EAAOO,GAnE7DW,QAAQC,IAAI,0CAAYZ,GACxB1B,EAAU0B,GACV5B,GAAS,IAiEH,+BAMR,OACE,iBAAKyC,UAAU,oCAAf,WACI,SAAC,IAAD,CAAO1B,QAASA,EAAS2B,WAAY5B,KACrC,SAAC,IAAD,CAAOE,MAAM,eAAK2B,QAAS5C,EAAO6C,KAxEvB,WACflC,IAAAA,KAAW,qCAAqC,CAACmC,OAAO1C,EAAUyB,GAAG3B,OAAOA,IAAS6C,MAAK,SAAAnC,GACxF4B,QAAQC,IAAI7B,GACU,MAAlBA,EAAKE,KAAKkC,OACZtC,EAAAA,GAAAA,QAAgBE,EAAKE,KAAKJ,QAAQ,GAClCT,GAAS,GACTgD,YAAW,WACTC,OAAOC,SAASC,WACf,OAEH1C,EAAAA,GAAAA,MAAcE,EAAKE,KAAKJ,QAAQ,GAChCT,GAAS,OAEVoD,OAAM,SAAAC,GACP5C,EAAAA,GAAAA,MAAc,4BAAQ,GACtBuC,YAAW,WACTC,OAAOC,SAASC,WACf,SAuDiDG,SAAU,WAAOtD,GAAS,IAA5E","sources":["pages/UserMenu/PointShop/Shop/index.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { Button, Image, Modal,Space, message, Table} from 'antd';\r\nimport axios from 'axios';\r\nexport default function Index() {\r\n  const [modal, setModal] = useState(false);\r\n  const [giftId, setGiftId] = useState();\r\n  let loginUser = JSON.parse(localStorage.getItem(\"loginUser\"));\r\n  useEffect(async() => {\r\n    message.destroy();\r\n    const resp = await axios.get(\"http://localhost:8080/queryAbleGift\")\r\n    setOriginData(resp.data.data)\r\n\r\n\r\n    // .then(resp=>{\r\n    //   if (resp.data.state === \"0\") {\r\n    //     const { data } = resp.data;\r\n    //     let rsList = []\r\n    //     for (let i = 0; i < data.length; i++) {\r\n    //       rsList.push({\r\n    //         id: data[i].id.toString(),\r\n    //         key: i,\r\n    //         name: data[i].name.toString(),\r\n    //         price: data[i].price.toString(),\r\n    //         stock: data[i].stock.toString(),\r\n    //       })\r\n    //     }\r\n    //     setOriginData(rsList)\r\n\r\n    //   } else {\r\n    //     message.err(resp.data.message, 1)\r\n    //     setOriginData = []\r\n    //   }\r\n    // }).catch(err => {\r\n    //   console.log(err);\r\n    //   message.error(\"请求失败!\", 1)\r\n    // })\r\n    return () => {\r\n    };\r\n  }, []);\r\n  const [originData, setOriginData] = useState(0);\r\n  const exchange = (id) => {\r\n    console.log('兑换礼物的id是:',id);\r\n    setGiftId(id);\r\n    setModal(true);\r\n  }\r\n  const handleOk = () => {\r\n    axios.post(\"http://localhost:8080/exchangeGift\",{userid:loginUser.id,giftId:giftId}).then(resp=>{\r\n      console.log(resp);\r\n      if (resp.data.state===\"0\") {\r\n        message.success(resp.data.message,1)\r\n        setModal(false)\r\n        setTimeout(() => {\r\n          window.location.reload()\r\n        }, 800);\r\n      }else{\r\n        message.error(resp.data.message,1)\r\n        setModal(false)\r\n      }\r\n    }).catch(err=>{\r\n      message.error(\"网络异常!\",1)\r\n      setTimeout(() => {\r\n        window.location.reload()\r\n      }, 800);\r\n    })\r\n     \r\n    }\r\n    \r\n  \r\n  const columns = [\r\n    {\r\n      title: '礼品名称',\r\n      dataIndex: 'name',\r\n      width: '20%',\r\n    },\r\n    {\r\n      title: '图片',\r\n      dataIndex: 'photo',\r\n      width: '20%',\r\n      render: (text, record) => (\r\n        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', }}>\r\n          <Image\r\n            width={100}\r\n            height={100}\r\n            src={`http://localhost:8080/getGiftPhoto?id=${record.id}`}\r\n          />\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: '价格',\r\n      dataIndex: 'price',\r\n      width: '20%',\r\n      align: 'center',\r\n      defaultSortOrder: 'descend',\r\n      sorter: (a, b) => a.price - b.price,\r\n    },\r\n    {\r\n      title: '库存',\r\n      dataIndex: 'stock',\r\n      width: '20%',\r\n      align: 'center'\r\n    },\r\n    {\r\n      title: 'Action',\r\n      key: 'action',\r\n      width: '15%',\r\n      render: (text, record) => (\r\n        <Space size=\"middle\">\r\n          <Button type=\"primary\" onClick={() => {exchange(record.id)}}>兑换</Button>\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"animate__animated animate__fadeIn\">\r\n        <Table columns={columns} dataSource={originData} />\r\n        <Modal title=\"提示\" visible={modal} onOk={handleOk} onCancel={() => {setModal(false)}}>\r\n                确认兑换?\r\n             </Modal>\r\n    </div>\r\n\r\n  )\r\n}\r\n"],"names":["Index","useState","modal","setModal","giftId","setGiftId","loginUser","JSON","parse","localStorage","getItem","useEffect","message","axios","resp","setOriginData","data","originData","columns","title","dataIndex","width","render","text","record","style","display","justifyContent","alignItems","height","src","id","align","defaultSortOrder","sorter","a","b","price","key","size","type","onClick","console","log","className","dataSource","visible","onOk","userid","then","state","setTimeout","window","location","reload","catch","err","onCancel"],"sourceRoot":""}